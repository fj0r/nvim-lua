$schema: "http://json-schema.org/draft-07/schema#"
title: "mutagen schema"
type: object
properties:
  beforeCreate:
    type: array
    items:
      type: string
  afterCreate:
    type: array
    items:
      type: string
  afterPause:
    type: array
    items:
      type: string
  beforeResume:
    type: array
    items:
      type: string
  afterTerminate:
    type: array
    items:
      type: string
  commands:
    type: object
    patternProperties:
      ".+":
        type: string
    additionalProperties: false
  forward:
    type: object
    patternProperties:
      "^.+$":
        type: object
        properties:
          source:
            type: string
          destination:
            type: string
    additionalProperties: false
  sync:
    $ref: '#/definitions/sync'
definitions:
  sync:
    id: '#/definitions/sync'
    type: object
    patternProperties:
      defaults:
        $ref: '#/definitions/syncDefault'
      "^.+$":
        $ref: '#/definitions/syncProj'
    additionalProperties: false

  syncDefault:
    id: '#/definitions/syncDefault'
    type: object
    properties:
      flushOnCreate:
        type: boolean
        default: true
      ignore:
        $ref: '#/definitions/ignore'
      permissions:
        type: object
        properties:
          defaultFileMode:
            type: integer
            default: 644
          defaultDirectoryMode:
            type: integer
            default: 755


  ignore:
    id: '#/definitions/ignore'
    type: object
    properties:
      vcs:
        type: boolean
        default: true
      paths:
        type: array
        items:
          type: string

  syncProj:
    id: '#/definitions/syncProj'
    type: object
    properties:
      alpha:
        type: string
        default: .
      beta:
        type: string
      mode:
        type: string
        enum:
        - two-way-safe
        - two-way-resolved
        - one-way-safe
        - one-way-replica
      ignore:
        $ref: '#/definitions/ignore'

